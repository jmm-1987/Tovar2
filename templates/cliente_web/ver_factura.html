{% extends "cliente_web/base.html" %}

{% block title %}Factura {{ factura.serie }}-{{ factura.numero }} - Área Cliente{% endblock %}

{% block content %}
<div style="margin-bottom: 20px;">
    <a href="{{ url_for('cliente_web.ver_facturas') }}" class="btn btn-secondary">← Volver a Mis Facturas</a>
</div>

<div class="card">
    <h2>Factura {{ factura.serie }}-{{ factura.numero }}</h2>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
        <div>
            <h3 style="color: #667eea; margin-bottom: 15px; font-size: 18px;">Información de la Factura</h3>
            <p><strong>Número:</strong> {{ factura.serie }}-{{ factura.numero }}</p>
            <p><strong>Fecha de Expedición:</strong> {{ factura.fecha_expedicion.strftime('%d/%m/%Y') if factura.fecha_expedicion else 'N/A' }}</p>
            <p><strong>Tipo:</strong> {{ factura.tipo_factura }}</p>
            <p><strong>Estado:</strong> 
                <span style="padding: 5px 12px; border-radius: 5px; background: #d4edda; color: #155724; font-size: 14px; font-weight: 600;">
                    {{ factura.estado }}
                </span>
            </p>
        </div>
        
        <div>
            <h3 style="color: #667eea; margin-bottom: 15px; font-size: 18px;">Importes</h3>
            <p style="font-size: 24px; font-weight: bold; color: #667eea;">
                Total: {{ "%.2f"|format(factura.importe_total) }} €
            </p>
            {% if factura.descripcion %}
            <p style="margin-top: 15px;"><strong>Descripción:</strong></p>
            <div style="background: #f8f9fa; padding: 10px; border-radius: 5px; margin-top: 5px;">
                {{ factura.descripcion | nl2br }}
            </div>
            {% endif %}
        </div>
    </div>
</div>

<div class="card">
    <h2>Líneas de Factura</h2>
    {% if factura.lineas %}
    <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
        <thead>
            <tr style="border-bottom: 2px solid #e0e0e0; background: #f8f9fa;">
                <th style="text-align: left; padding: 12px;">Descripción</th>
                <th style="text-align: center; padding: 12px;">Cantidad</th>
                <th style="text-align: right; padding: 12px;">Precio Unit.</th>
                <th style="text-align: right; padding: 12px;">Importe</th>
            </tr>
        </thead>
        <tbody>
            {% for linea in factura.lineas %}
            <tr style="border-bottom: 1px solid #f0f0f0;">
                <td style="padding: 12px;">{{ linea.descripcion }}</td>
                <td style="padding: 12px; text-align: center;">{{ "%.2f"|format(linea.cantidad) }}</td>
                <td style="padding: 12px; text-align: right;">{{ "%.2f"|format(linea.precio_unitario) }} €</td>
                <td style="padding: 12px; text-align: right; font-weight: 600;">{{ "%.2f"|format(linea.importe) }} €</td>
            </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr style="border-top: 2px solid #667eea; background: #f8f9ff;">
                <td colspan="3" style="padding: 12px; text-align: right; font-weight: 600;">Total:</td>
                <td style="padding: 12px; text-align: right; font-weight: 600; font-size: 18px; color: #667eea;">
                    {{ "%.2f"|format(factura.importe_total) }} €
                </td>
            </tr>
        </tfoot>
    </table>
    {% else %}
    <p style="color: #666; margin-top: 20px;">No hay líneas en esta factura.</p>
    {% endif %}
</div>
{% endblock %}




